# 1.介绍

对很多应用来说，至关重要的是预测互相关多变量的能力。这些应用广泛分布于图片分割及分类、围棋胜负概率的预测、在DNA序列中分离基因组，以及对自然文本进行语法分割。在这些应用中，我们想基于一组观测值$$\boldsymbol x$$，来预测一个随机输出向量$$\boldsymbol y={y_0,y_1,...,y_T}$$。一个相对简单的例子是对自然语言进行词性标注。其中，每个$$y_s$$对应着s位置的单词的词性，而输入$$\boldsymbol x$$被划分成多个输入特征向量$$\{\boldsymbol x_0,\boldsymbol x_1,...,\boldsymbol x_T\}$$。每个$$\boldsymbol x_s$$ 包含着s位置单词的多种信息，如它自身、它的前后缀、它在词典中的身份，以及来自语义数据库的信息（如WordNet）。（专业词汇有问题）

一种办法是为每个位置s训练位置无关的分类器$$\boldsymbol x \to y_s$$，尤其是当我们要最大化$$y_s$$的正确率时。然而，困难在于输入变量$$y_s$$之间存在复杂的依赖性。如在英语中，形容词不常接名词。又如在计算机视觉中，临近区域趋向属于相近的类。另一个难点在于，输出变量常常表现出一种复杂的结构，如语法树。那么，在树的顶端附近选择怎样的语法规则会对整个树有极大的影响。（译注：$$\boldsymbol x \to y_s$$表示每个$$y_s,s\in\{1,...,T\}$$独自有一个分类器，而每个把全部x作为输入。上一段还提到对x进行划分，这里却突然合并了。）

图模型是一种表达互相关变量的自然的方法。图模型包括：贝叶斯网络，神经网络，因子图，马尔科夫随机场，伊辛模型（Ising model）等等。它们把一个复杂的概率分布划分成许多局部**因子\(factor\)**相乘（译注：能相乘的概率是相互独立的），而这些因子各自对应着变量的一部分。我们有可能描述，按照一组条件独立关系对概率密度进行的划分，能在多大程度上满足着该分布（译注：暂时理解不了这句话也没关系）。这种对应关系，使得建模更加容易，因为我们的经验知识常常提供了合理的条件独立假设，而这决定了我们如何进行划分。

关于图模型的工作，特别是自然语言处理相关的，大量地关注了**生成模型（generative models）**。生成模型显式地建立对所有输入和输出的联合分布$$p(\boldsymbol y,\boldsymbol{x}）$$。尽管这有一些好处，但存在着重要的局限。不仅是因为输入$$\boldsymbol x$$的维度可能非常大，还因为输入$$\boldsymbol x$$内在的复杂的相关性。对它们进行建模是困难的。对输入的相关性进行建模，会导致难以驾驭的模型，而忽略它们却会降低系统的性能。

一种解决办法是**判别**方法，正如在逻辑回归分类器中的做法。这里，我们直接对$$p(\boldsymbol{y|x})$$建模，因为这是完成分类所需的全部。这正是条件随机场（CRFs）所采用的方法。CRFs结合了判别分类器与图模型的优点。一方面能够紧凑地对多变量输出$$\boldsymbol y$$进行建模，一方面能够应付数量庞大的输入特征$$\boldsymbol x$$，以用于预测。条件模型的优势在于，它忽略了那些仅仅存在于$$\boldsymbol x$$内在变量之间的相关性。因此，条件模型要比联合模型具有简单得多的结构。生成模型和CRFs之间的差别，与简单贝叶斯和逻辑回归分类器之间的差别一致。实质上，多元逻辑回归模型可以被看成一种最简单的CRF，因它只有一个输出。

本文描述了CRFs的 建模、推断（前向计算）和参数估计方法。读者不用具有图模型的知识，因而本文希望能对广大的实践者有用。我们从介绍CRFs建模的一些问题开始（第二章），包括线性CRFs通用结构的CRFs，以及包含潜藏变量的隐CRFs（hidden crfs）。我们将说明，为何CRFs既是著名的逻辑回归的扩展，有是判别式的隐马尔科夫模型。

在接下来的两章，我们描述了推断（第4章）和学习（第5章）。**推断**既指计算$$p(\boldsymbol{y|x)}$$的边缘分布，也指计算极大似然$$\boldsymbol y^{*} =argmax_y p(\boldsymbol{y|x})$$。**学习**是指参数估计过程，就是找到$$p(\boldsymbol{y|x)}$$的参数，使其最大限度地符合一组训练样本$$\{\boldsymbol x^{(i)}, \boldsymbol y^{(i)}\}^N_{i=1}$$。推断和学习过程往往密切地组合在一起，因为学习过程需要推断做为子过程。

最后，我们讨论了CRFs与其他类模型的关系，包括结构化预测模型，神经网络和最大熵马尔科夫模型（第6章）。

### 1.1动手方面的细节

本文努力指出动手实现方面的细节，而这常常被学术文献所忽略。例如，我们讨论了特征工程（feature engineering输入设计？）（第2.5节），在推断中避免数值溢出（第4.3节），CRF在一些基准问题上训练时的伸缩性。

因为这是我们关于实现细节的第一个章节，应该提一提可供使用的一些CRFs平台。在写作本文时，一些流行的平台包括：

|  CRF++| http://crfpp.sourceforge.net/ |
| :--- | :--- |
| MALLET|http://mallet.cs.umass.edu/ |
| GRMM | http://mallet.cs.umass.edu/grmm/|
|CRFSuite | http://www.chokkan.org/software/crfs |
|FACTORIE | http://www/factorie.cc |

除此之外，用于马尔科夫逻辑网络的软件（如Alchemy：http://alchemy.cs.washington.edu/)也可用于构建CRF模型。 据我们所知，Alchemy, GRMM 和 FACTORIE 是仅有的、能够处理任意的图模型的工具。




