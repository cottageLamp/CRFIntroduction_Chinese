# 3 算法总览

接下来的两节中，我们将讨论CRFs的推断和参数估计。**参数估计Parameter estimation**是要找到一组参数$$\theta$$，使得分布$$p(y|x,\theta)$$与一组输入输出均已知的训练样本$$D=\{x^{(i)},y^{(i)}\}^N_{i=1}$$相匹配。我们希望，给定任何一个输入样本$$x^{(i)}$$，从模型推断出的关于输出的分布$$p(y|x^{(i)},\theta)$$，能“像是”从训练数据中得来的真实的输出$${y}^{(i)}$$。

要量化地来理解这一点，可考虑模型中定义的特征函数。考虑线性链CRF。我们希望，随机地从模型中选择一个输入序列x，然后从$p(y|x,\theta)$中采样y，触发特征$$f_k(y_t,y_{t-1},x_t)$$的概率，能与训练数据中$$f_k$$发生的概率相等。正式地，要求$$f_k$$满足：

$$
\sum^T_{i=1}\sum^T_{t=1}f_k(y_t^{(i)})=\sum^N_{i=1}\sum^T_{t=1}\sum_{y,y'}f_k(y,y',x_t^{(i)}p(y_t=y,y_{t-1}=y'|x^{(i)}).
$$

重要的是，这一方程组可被看成某个关于参数的目标函数的梯度。这一点是很重要的，因为当我们拥有这一目标函数之后，可以用标准的数值方法来优化它。拥有这一特性的目标函数是如下的似然

$$
\mathcal{l}(\theta)=p(y^{(i)},|x^{(i)},\theta)=\sum^N_{i=1}\sum^T_{t=1}\sum^K_{k=1}\theta_kf_k(y_t^{(i)},y_{t-1}^{(i)},x_t^{(i)})-\sum^N_{i=1}\log Z(x^{(i)}),
$$

这是训练样本在模型意义下的概率，是关于参数的函数。

训练CRFs的标准方法是最大化似然，即寻找$$\hat{\theta}_{ML}=\sup_{\theta}\mathcal{l}(\theta)$$。就是说，$$\hat{\theta}_{ML}$$是最有可能产生训练数据的参数。可将似然对其参数求偏导数并置为0，即得前面讨论的方程组。这恰恰会产生我们刚说的，关于特征的期望。

尽管我们只讨论了线性链CRF的极大似然，同样的想法也适用于通用CRFs。在通用CRFs中，不用链条邻域间的变量的边缘分布$$p(y_t,y_{t-1}|x,\theta)$$，而是通用图模型中一个因子a上的所有变量$$Y_a$$的边缘分布$$p(y_a|x,\theta)$$。

